Mô tả nội dung:
Bên dưới là việc thu thập và tổng hơp dữ liệu trích xuất từ 2 hệ thống  FE và BE
Vấn đề cần xử lý tiếp theo là đối soát việc chênh lệch thu phí giữa 2 cột (Phí thu và BE_Tiền bao gồm thuế) cho cùng 1 xe dựa trên cột (Số xe đăng ký, nếu cột này trống thì lấy cột BE_Biển số xe)

    Có các trường hợp như:
        - Trên cùng 1 xe (Số xe đăng ký), do có thể gắn nhiều BE_Số etag, nên khi vào trạm máy quét đọc cả các mã BE_Số etag được gắn trên xe nên cùng lúc đó trừ hàng loạt phí thu cho 1 lần xe qua trạm. Điều này thể hiện qua việc kiểm tra khi nhóm cùng 1 biển số qua các dòng thì có dòng Phí thu >0 còn BE_Tiền bao gồm thuế =0, Nghĩa là FE thu phí còn BE thì hoàn lại tiền cho chủ xe.       
        
       
        -Trên cùng 1 xe (Số xe đăng ký), qua cùng trạm (trạm có nhiều làn, mỗi làn gắn 1 camare quét mã và thể gắn trên xe) nhưng có thể các camare làn khác cũng đọc được nên FE cùng lúc thu phí qua các làn và các thẻ gắn trên xe lúc đó (thời gian đọc mã giữa các làn khác nhau, cả BE và FE cũng khác nhau do phụ thuộc vào việc đọc truyền dữ liệu)

    Nhiệm vụ tôi làm sao để đối soát tổng hợp dữ liệu có thể nhìn vào cột ghi chú phát hiện ra việc sai lệch giữa FE và BE
    Hãy cho tôi quy trình và giải pháp tổng hợp dữ liệu theo nội dung trên

        Mã giao dịch Số xe đăng ký                     Mã thẻ  ...  BE_Thời gian qua trạm       BE_Làn Chênh lệch (Phí thu)
0                                                     '0       KP-4595  '3416214B888C000000846106  ...                    NaN          NaN                    0
1                                                     '0        KP4011  '3416214B80009A540200B7AC  ...                    NaN          NaN                    0
2                                                     '0       KP-4683  '3416214B882DEB0001156158  ...                    NaN          NaN                    0
3                                                     '0        KP4214  '3416214B9400CCEE01057726  ...                    NaN          NaN                    0
4                                                     '0       TK-8087  '3416214B882EA40001143556  ...                    NaN          NaN                    0
...                                                  ...           ...                        ...  ...                    ...          ...                  ...
20716                                        '1742211198      50H20950  '3416214B8866B30004215995  ...    16/04/2025 23:58:02  Làn 11 (2A)                    0
20717                                        '1742211306      50H60567  '3416214B885C010005441927  ...    16/04/2025 23:58:17   Làn 6 (3A)                    0
20718                                        '1742211738      60A94391  '3416214B80007030A200DB56  ...    16/04/2025 23:59:10  Làn 11 (2A)                    0
20719                                        '1742212105      60H13087  '3416214B88B9BB0005562457  ...                    NaN          NaN                    0
20720  Tổng cộng: FE có 15156 giao dịch, BE có 15269 ...           NaN                        NaN  ...                    NaN          NaN              2501000

Sau khi chuyển đổi về list có dạng sau:
[["'0", 'KP-4595', "'3416214B888C000000846106", 0.0, '11', "'16-04-2025 03:47:06", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP4011', "'3416214B80009A540200B7AC", 0.0, '12', "'16-04-2025 03:58:29", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4683', "'3416214B882DEB0001156158", 0.0, '12', "'16-04-2025 03:58:43", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP4214', "'3416214B9400CCEE01057726", 0.0, '12', "'16-04-2025 03:58:48", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'TK-8087', "'3416214B882EA40001143556", 0.0, '11', "'16-04-2025 04:45:48", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'TK-7982', "'3416214B8826AB0001143538", 0.0, '10', "'16-04-2025 04:59:44", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'TK-7971', "'3416214B88C3CD0001143551", 0.0, '10', "'16-04-2025 05:17:37", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3950', "'3416214B8842000000846137", 0.0, '11', "'16-04-2025 05:45:44", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'TK-7982', "'3416214B8826AB0001143538", 0.0, '12', "'16-04-2025 06:00:51", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5159', "'3416214B9400F10E0006758A", 0.0, '10', "'16-04-2025 06:02:26", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5159', "'3416214B9400F10E0006758A", 0.0, '12', "'16-04-2025 06:19:53", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '00A52051', "'3416214B94003222A003E38D", 0.0, '10', "'16-04-2025 06:20:44", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '00A52030', "'3416214B94003FF4000409E2", 0.0, '10', "'16-04-2025 06:21:05", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3935', "'3416214B885E000000846141", 0.0, '12', "'16-04-2025 06:22:23", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '00A52030', "'3416214B94003FF4000409E2", 0.0, '12', "'16-04-2025 07:08:35", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4371', "'3416214B88A6000000846198", 0.0, '10', "'16-04-2025 07:13:32", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4383', "'3416214B88A8000000846110", 0.0, '10', "'16-04-2025 07:13:42", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-5031', "'3416214B8851000000846132", 0.0, 
'12', "'16-04-2025 07:38:44", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'TH1359', "'3416214B9400C2F80003DF54", 0.0, '12', "'16-04-2025 07:39:43", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4655', "'3416214B888E830001156243", 0.0, '10', "'16-04-2025 07:48:25", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4220', "'3416214B88F4000000846188", 0.0, '10', "'16-04-2025 07:51:51", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4655', "'3416214B888E830001156243", 0.0, '12', "'16-04-2025 08:07:47", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5159', "'3416214B9400F10E0006758A", 0.0, '12', "'16-04-2025 08:11:38", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3935', "'3416214B885E000000846141", 0.0, '12', "'16-04-2025 08:12:06", 
'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP3728', "'3416214B94009EFA000674E9", 0.0, '10', "'16-04-2025 08:17:51", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5229', "'3416214B94003CDC00044BA0", 0.0, '10', "'16-04-2025 08:28:14", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5039', "'3416214B94005F76000674E5", 0.0, '12', "'16-04-2025 08:40:01", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3935', "'3416214B885E000000846141", 0.0, '12', "'16-04-2025 08:56:38", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5159', "'3416214B9400F10E0006758A", 0.0, '12', "'16-04-2025 08:58:00", 
'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP3728', "'3416214B94009EFA000674E9", 0.0, '12', "'16-04-2025 09:19:32", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4220', "'3416214B88F4000000846188", 0.0, '12', "'16-04-2025 09:20:09", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5229', "'3416214B94003CDC00044BA0", 0.0, '10', "'16-04-2025 09:35:19", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4371', "'3416214B88A6000000846198", 0.0, '12', "'16-04-2025 09:43:53", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'AM-1057', "'3416214B8899EE0005193400", 0.0, '11', "'16-04-2025 09:45:40", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'TH1359', "'3416214B9400C2F80003DF54", 0.0, '11', "'16-04-2025 09:47:09", 'UT toàn quốc', nan, nan, nan, 
nan, nan, nan, 0], ["'0", 'KP4011', "'3416214B80009A540200B7AC", 0.0, '10', "'16-04-2025 10:40:21", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4683', "'3416214B882DEB0001156158", 0.0, '10', "'16-04-2025 10:40:33", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP4214', "'3416214B9400CCEE01057726", 
0.0, '10', "'16-04-2025 10:40:37", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'BH-5431', "'3416214B881C000000740402", 0.0, '10', "'16-04-2025 10:42:02", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'BH5385', "'3416214B9400AD5FA0000A64", 0.0, '10', "'16-04-2025 10:42:31", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3950', "'3416214B8842000000846137", 0.0, '12', "'16-04-2025 10:48:17", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5159', "'3416214B9400F10E0006758A", 0.0, '12', "'16-04-2025 10:50:53", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'AM-1057', "'3416214B8899EE0005193400", 0.0, '12', "'16-04-2025 10:52:44", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3935', "'3416214B885E000000846141", 0.0, '12', "'16-04-2025 10:52:49", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3957', "'3416214B8872000000846366", 0.0, '10', "'16-04-2025 11:07:45", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-5031', "'3416214B8851000000846132", 0.0, '10', "'16-04-2025 11:27:57", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4369', "'3416214B88A5220002186956", 0.0, '10', "'16-04-2025 11:29:35", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'BH-5431', "'3416214B881C000000740402", 0.0, '12', "'16-04-2025 11:31:51", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'BH5385', "'3416214B9400AD5FA0000A64", 0.0, '12', "'16-04-2025 11:32:56", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '00A52030', "'3416214B94003FF4000409E2", 0.0, '10', "'16-04-2025 11:37:32", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '00A52030', "'3416214B94003FF4000409E2", 0.0, '12', "'16-04-2025 11:57:41", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '60C5577', "'3416214B9400297BA003E7B3", 0.0, '11', "'16-04-2025 12:01:16", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'TK-7971', "'3416214B88C3CD0001143551", 0.0, '12', "'16-04-2025 12:12:54", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4369', "'3416214B88A5220002186956", 0.0, '12', "'16-04-2025 12:26:26", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-5031', "'3416214B8851000000846132", 0.0, '12', "'16-04-2025 13:15:58", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5312', "'3416214B9400D14C00067588", 0.0, '10', "'16-04-2025 13:36:29", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3957', "'3416214B8872000000846366", 0.0, '12', "'16-04-2025 13:43:09", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP4214', "'3416214B9400CCEE01057726", 0.0, '12', "'16-04-2025 15:06:05", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5159', "'3416214B9400F10E0006758A", 0.0, '12', "'16-04-2025 15:13:03", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3935', "'3416214B885E000000846141", 0.0, '12', "'16-04-2025 15:13:52", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4383', "'3416214B88A8000000846110", 0.0, '12', "'16-04-2025 15:16:58", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-5031', "'3416214B8851000000846132", 0.0, '10', "'16-04-2025 15:22:56", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5312', "'3416214B9400D14C00067588", 0.0, '10', "'16-04-2025 15:40:50", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4369', "'3416214B88A5220002186956", 0.0, '12', "'16-04-2025 15:55:49", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '60B06308', "'3416214B940099AA0005E31A", 0.0, '12', "'16-04-2025 16:04:03", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP5312', "'3416214B9400D14C00067588", 0.0, '12', "'16-04-2025 16:06:53", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 
0], ["'0", 'KP5229', "'3416214B94003CDC00044BA0", 0.0, '11', "'16-04-2025 16:18:19", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '60B06308', "'3416214B940099AA0005E31A", 0.0, '10', "'16-04-2025 16:38:01", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3950', "'3416214B8842000000846137", 0.0, '12', "'16-04-2025 16:44:49", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3935', "'3416214B885E000000846141", 0.0, '12', "'16-04-2025 17:13:16", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-5062', "'3416214B88D5000000846145", 0.0, '10', "'16-04-2025 17:16:39", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'BB4252', "'3416214B88FC790001140221", 0.0, '11', "'16-04-2025 18:01:58", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-5136', "'3416214B88268B0001156435", 0.0, '10', "'16-04-2025 18:19:36", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '60A00983', "'3416214B94009D47A003E434", 0.0, '11', "'16-04-2025 19:24:22", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-5136', "'3416214B88268B0001156435", 0.0, '12', "'16-04-2025 19:32:26", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP4011', "'3416214B80009A540200B7AC", 0.0, '12', "'16-04-2025 19:32:30", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4683', "'3416214B882DEB0001156158", 0.0, '12', "'16-04-2025 19:32:47", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", '00A52051', "'3416214B94003222A003E38D", 0.0, '10', "'16-04-2025 20:18:47", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'QA-5006', "'3416214B888FF80001155374", 0.0, 
'10', "'16-04-2025 20:51:35", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'QA-5006', "'3416214B888FF80001155374", 0.0, '12', "'16-04-2025 21:04:10", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-3950', "'3416214B8842000000846137", 0.0, '11', "'16-04-2025 21:35:37", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'0", 'KP-4369', "'3416214B88A5220002186956", 0.0, '11', "'16-04-2025 21:48:17", 'UT toàn quốc', nan, nan, nan, nan, nan, nan, 0], ["'1740672323", 
nan, nan, nan, nan, nan, nan, '51A-712.35T', '3416214B8877920004086754', 'Miễn phí quay đầu', 0.0, '16/04/2025 00:00:25', 'Làn 12 (2B)', 0], ["'1740672388", '61A89574', "'3416214B9400AC4202061768", 19000.0, '01', "'16-04-2025 00:00:29", 'Vé lượt thường', '61A89574T', '3416214B9400AC4202061768', 'Giá thường', 19000.0, '16/04/2025 00:00:32', 'Làn 1 (1A)', 0], ["'1740672530", '60C48339', "'3416214B94004555010AE233", 19000.0, '12', "'16-04-2025 00:03:02", 'Vé lượt thường', '60C48339T', '3416214B94004555010AE233', 'Giá thường', 19000.0, '16/04/2025 00:00:50', 'Làn 12 (2B)', 0], ["'1740672664", '60K56924', "'3416214B88E7630007400885", 19000.0, '01', "'16-04-2025 00:01:03", 'Vé lượt thường', '60K-569.24T', '3416214B88E7630007400885', 'Giá thường', 19000.0, '16/04/2025 00:01:08', 'Làn 1 (1A)', 0], ["'1740673361", nan, nan, nan, nan, nan, nan, '70A45293T', '3416214B9400061FA201B34B', 'Miễn phí quay đầu', 0.0, '16/04/2025 00:02:36', 'Làn 6 (3A)', 0], ["'1740673450", '61H14816', "'3416214B882C4B0007215206", 19000.0, '11', "'16-04-2025 00:02:44", 'Vé lượt thường', '61H-148.16V', '3416214B882C4B0007215206', 'Giá thường', 19000.0, '16/04/2025 00:02:46'
